{
  "type": "workflow_collections",
  "data": [
    {
      "@type": "WorkflowCollection",
      "name": "Sample - STIX - 1.0.0",
      "description": "Sample playbooks for \"STIX\" connector. If you are planning to use any of the sample playbooks in your environment, ensure that you clone those playbooks and move them to a different collection, since the sample playbook collection gets deleted during connector upgrade and delete.",
      "visible": true,
      "image": "data:png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAIAAAABc2X6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDYuMC1jMDA2IDc5LmRhYmFjYmIsIDIwMjEvMDQvMTQtMDA6Mzk6NDQgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6MDVhMzk2YTUtYjc4Yy00ZDUwLWE0NmItOGQyZDcyNmEzYzU1IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjEyMzY2QjcwQkJCMTExRUJBMjlGRDYyRjM5MDUyQTRFIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjEyMzY2QjZGQkJCMTExRUJBMjlGRDYyRjM5MDUyQTRFIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCAyMS4yIChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6YTEwMThkNWMtYmVhMC00MmFkLWI3YTYtY2E1OTBlMzhkOTQ5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjA1YTM5NmE1LWI3OGMtNGQ1MC1hNDZiLThkMmQ3MjZhM2M1NSIv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",
      "uuid": "6ba2fe73-1eef-40a9-89e8-6b81be363eba",
      "id": 67,
      "deletedAt": null,
      "importedBy": [],
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Extract Indicators From STIX File",
          "aliasName": null,
          "tag": null,
          "description": "Extract indicators from the submitted STIX file",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1642754563,
          "collection": "/api/3/workflow_collections/6ba2fe73-1eef-40a9-89e8-6b81be363eba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/a8096d6a-41df-4a30-9b6c-c234fab1f5f9",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Fetch and Create",
              "description": null,
              "arguments": {
                "name": "STIX",
                "config": "b048e135-532c-4d91-9ed3-6f6b47d34459",
                "params": {
                  "tlp": "Amber",
                  "expiry": 90,
                  "file_id": "{{vars.input.records[0].file['@id']}}",
                  "confidence": 50,
                  "reputation": "Suspicious",
                  "output_mode": "Create as Feed Records in FortiSOAR",
                  "create_pb_id": "2928194f-626b-4aaf-8a34-f93db81b3ebd"
                },
                "version": "1.0.0",
                "connector": "stix",
                "operation": "extract_indicators",
                "operationTitle": "Extract Indicators From STIX File",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "0e08a874-2378-4554-91ab-83c9b51d5747"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "1cfa46c3-a4ab-4fe8-a4dc-c1397f830b11",
                "resources": [
                  "attachments"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  },
                  "loggedInUser": "{{vars.currentUser | fromIRI }}"
                },
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "attachments": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "a8096d6a-41df-4a30-9b6c-c234fab1f5f9"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Extract Indicators From STIX File",
              "targetStep": "/api/3/workflow_steps/0e08a874-2378-4554-91ab-83c9b51d5747",
              "sourceStep": "/api/3/workflow_steps/a8096d6a-41df-4a30-9b6c-c234fab1f5f9",
              "label": null,
              "isExecuted": false,
              "uuid": "3473c617-0b90-4cb4-832e-4d8135c917af"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "244c3a03-785f-49b5-83f2-3f1d65aa74d4",
          "id": 647,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "STIX"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> Extract Indicators From STIX File > Create Indicators",
          "aliasName": null,
          "tag": null,
          "description": "Create indicators from the submitted STIX file",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "ingestedData"
          ],
          "synchronous": false,
          "lastModifyDate": 1642754757,
          "collection": "/api/3/workflow_collections/6ba2fe73-1eef-40a9-89e8-6b81be363eba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/ff75128e-cd1f-4e5e-a438-05b8d8f174e1",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "tlp_map": "{'Red': {{'TrafficLightProtocol'| picklist('Red') }}, 'Amber': {{'TrafficLightProtocol'| picklist('Amber') }}, 'Green': {{'TrafficLightProtocol'| picklist('Green') }}, 'White': {{'TrafficLightProtocol'| picklist('White') }}}",
                "reputation_map": "{'Good': {{'IndicatorReputation'| picklist('Good') }}, 'Malicious': {{'IndicatorReputation'| picklist('Malicious') }}, 'Suspicious': {{'IndicatorReputation'| picklist('Suspicious') }}, 'TBD': {{'IndicatorReputation'| picklist('TBD') }}, 'No Reputation Available': {{'IndicatorReputation'| picklist('No Reputation Available') }}}",
                "threat_intelligence_typeofindicator_map": "{'domain-name-value': {{'ThreatIntelFeedType'| picklist('Domain') }}, 'file-name': {{'ThreatIntelFeedType'| picklist('Filename') }}, 'file-hashes-MD5': {{'ThreatIntelFeedType'| picklist('FileHash-MD5') }}, 'file-hashes-SHA-1': {{'ThreatIntelFeedType'| picklist('FileHash-SHA1') }}, 'file-hashes-SHA-256': {{'ThreatIntelFeedType'| picklist('FileHash-SHA256') }}, 'ipv4-addr-value': {{'ThreatIntelFeedType'| picklist('IPv4 Address') }}, 'ipv6-addr-value': {{'ThreatIntelFeedType'| picklist('IPv6 Address') }}, 'windows-registry-key-key': {{'ThreatIntelFeedType'| picklist('Registry') }}, 'process-name': {{'ThreatIntelFeedType'| picklist('Process') }}, 'url-value': {{'ThreatIntelFeedType'| picklist('URL') }}, 'user-account-value': {{'ThreatIntelFeedType'| picklist('Actor') }}, 'email-message-from_ref-value': {{'ThreatIntelFeedType'| picklist('Email Address') }}, 'email-message-sender_ref-value': {{'ThreatIntelFeedType'| picklist('Email Address') }} }"
              },
              "status": null,
              "top": "120",
              "left": "240",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "40a0be32-e8e6-4e4c-ab82-d00b037351c5"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Record",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.input.params.ingestedData}}",
                  "__bulk": true,
                  "parallel": false,
                  "condition": "",
                  "batch_size": 8000
                },
                "resource": {
                  "tLP": "{{vars.item.tlp}}",
                  "value": "{{vars.item.pattern.split('= ')[-1].strip().replace(\" \",\"\")[1:-2]}}",
                  "source": "{{vars.item.name}}",
                  "created": "{{vars.item.created}}",
                  "pattern": "{{vars.item.pattern}}",
                  "modified": "{{vars.item.modified}}",
                  "__replace": "true",
                  "expiresOn": "{{vars.item.valid_until}}",
                  "validFrom": "{{vars.item.valid_from}}",
                  "confidence": "{{vars.item.confidence}}",
                  "reputation": "{{vars.item.reputation}}",
                  "sourceData": "{{ vars.item | toJSON}}",
                  "typeOfFeed": "{% if 'pattern' in vars.item %}{{ (vars.item.pattern.split(\" =\")[0].strip()[1:].replace(\":\",\"-\").replace(\".\",\"-\").replace(\"'\",\"\").replace(\" \",\"\")) | resolveRange(vars.threat_intelligence_typeofindicator_map)}}{% endif %}",
                  "description": "<p>{{ vars.item.description }}</p>"
                },
                "_showJson": false,
                "collection": "/api/ingest-feeds/threat_intel_feeds",
                "__recommend": [],
                "step_variables": []
              },
              "status": null,
              "top": "220",
              "left": "420",
              "stepType": "/api/3/workflow_step_types/7b221880-716b-4726-a2ca-5e568d330b3e",
              "group": null,
              "uuid": "958560c5-1318-471f-b037-2042dfc6f932"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "ff75128e-cd1f-4e5e-a438-05b8d8f174e1"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/40a0be32-e8e6-4e4c-ab82-d00b037351c5",
              "sourceStep": "/api/3/workflow_steps/ff75128e-cd1f-4e5e-a438-05b8d8f174e1",
              "label": null,
              "isExecuted": false,
              "uuid": "af2ba4e0-5d5e-44c8-a381-f1bab7ae5a29"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Create Record",
              "targetStep": "/api/3/workflow_steps/958560c5-1318-471f-b037-2042dfc6f932",
              "sourceStep": "/api/3/workflow_steps/40a0be32-e8e6-4e4c-ab82-d00b037351c5",
              "label": null,
              "isExecuted": false,
              "uuid": "405c69aa-cf8e-443c-b9ea-ebea2cedd740"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "2928194f-626b-4aaf-8a34-f93db81b3ebd",
          "id": 648,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "STIX"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Export Indicators in STIX Specification",
          "aliasName": null,
          "tag": null,
          "description": "Exports selected indicators from FortiSOAR in a valid STIX specification file",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1658485199,
          "collection": "/api/3/workflow_collections/6ba2fe73-1eef-40a9-89e8-6b81be363eba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/fdd23ec4-1bd0-421c-bb38-a8a64892909e",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create Attachment",
              "description": null,
              "arguments": {
                "params": {
                  "name": "{{vars.input.params.enterTheSTIXFilename}}",
                  "filename": "/tmp/{{vars.steps.Export_Indicator_in_STIX_Spec.data.filename}}",
                  "description": "",
                  "request_headers": "",
                  "multipart_headers": "",
                  "extra_multipart_fields": ""
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "create_cyops_attachment",
                "operationTitle": "File: Create Attachment from File",
                "step_variables": []
              },
              "status": null,
              "top": "560",
              "left": "120",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "e4cf3ea0-ff4b-4fe6-9257-20afd71377a2"
            },
            {
              "@type": "WorkflowStep",
              "name": "Export Indicator in STIX Spec",
              "description": null,
              "arguments": {
                "name": "Stix2",
                "config": "83a5c5a4-017e-4cbf-b549-64e0be9ef700",
                "params": {
                  "tlp": "Amber",
                  "filename": "{% if 'json' in vars.input.params.enterTheSTIXFilename %}{{vars.input.params.enterTheSTIXFilename}}{% else %}{{vars.input.params.enterTheSTIXFilename}}.json{% endif %}",
                  "gen_role": "",
                  "rec_role": "",
                  "gen_class": "Organization",
                  "rec_class": "Organization",
                  "gen_sector": "",
                  "rec_sector": "",
                  "gen_org_name": "Alpha",
                  "rec_org_name": "Beta",
                  "spec_version": "2.1",
                  "file_response": true,
                  "gen_spec_info": true,
                  "rec_spec_info": true,
                  "indicator_list": "{{vars.steps.Find_Indicators}}",
                  "gen_contact_info": "",
                  "rec_contact_info": "",
                  "gen_org_description": "",
                  "rec_org_description": ""
                },
                "version": "1.0.0",
                "connector": "stix",
                "operation": "create_indicators",
                "operationTitle": "Export Indicators In STIX Spec",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "b81a1251-2835-4167-b765-62cab8408ef1"
            },
            {
              "@type": "WorkflowStep",
              "name": "Send Email",
              "description": null,
              "arguments": {
                "config": "88c3d39c-2fa9-4731-b00d-29815008f17c",
                "params": {
                  "cc": "",
                  "to": "{{vars.input.params.emailAddresses}}",
                  "bcc": "",
                  "from": "noreply@example.com",
                  "type": "Manual Input",
                  "content": "STIX Spec Export at {{ arrow.utcnow() }}",
                  "subject": "FSR STIX Spec File - {{vars.input.params.enterTheSTIXFileName}}",
                  "iri_list": "",
                  "body_type": "Plain Text",
                  "file_name": "{{vars.input.params.enterTheSTIXFileName}}.zip",
                  "file_path": "{{vars.steps.Compress_File.data['zip_filename']}}"
                },
                "version": "2.4.3",
                "from_str": "soc@cybersponse.com",
                "connector": "smtp",
                "operation": "send_email_new",
                "operationTitle": "Send Email",
                "step_variables": []
              },
              "status": null,
              "top": "705",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/4c0019b2-055c-44d0-968c-678a0c2d762e",
              "group": null,
              "uuid": "dec575d4-23ff-42b7-bbce-c75d288fe57e"
            },
            {
              "@type": "WorkflowStep",
              "name": "Compress File",
              "description": null,
              "arguments": {
                "params": {
                  "filename": "/tmp/{{vars.steps.Export_Indicator_in_STIX_Spec.data.filename}}",
                  "password": "",
                  "compress_level": 6,
                  "target_filename": "PlaybookExport-{{ arrow.utcnow().timestamp }}.zip"
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "zip_and_protect_file",
                "operationTitle": "File: Zip",
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "c6d98ec0-632a-4d8c-8462-416e6d4e2ed5"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "bc36b666-21c6-4fe9-a50b-3a1d4dd638d3",
                "resources": [
                  "indicators"
                ],
                "inputVariables": [
                  {
                    "name": "enterTheSTIXFilename",
                    "type": "string",
                    "label": "Enter the STIX Filename",
                    "tooltip": "",
                    "dataType": "text",
                    "formType": "text",
                    "required": true,
                    "_expanded": true,
                    "defaultValue": null,
                    "_previousName": "enterTheSTIXIlename",
                    "useRecordFieldDefault": false
                  },
                  {
                    "name": "doYouWantToSendSTIXFileThroughEmail",
                    "type": "boolean",
                    "label": "Do you want to send STIX file through Email",
                    "title": "Checkbox",
                    "usable": true,
                    "tooltip": "If yes, then please specify the email address. If email address is not provided, STIX file will be created as an attachment in FortiSOAR",
                    "dataType": "checkbox",
                    "formType": "checkbox",
                    "required": false,
                    "_expanded": true,
                    "mmdUpdate": true,
                    "bulkAction": [],
                    "collection": false,
                    "dataSource": [],
                    "searchable": true,
                    "templateUrl": "app/components/form/fields/checkbox.html",
                    "defaultValue": null,
                    "_previousName": "doYouWantToSendSTIXFileThroughEmai",
                    "inversedField": null,
                    "displayTemplate": "%7B%7B%20itemValue%20%7D%7D",
                    "lengthConstraint": false,
                    "ownsRelationship": false,
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  },
                  {
                    "name": "emailAddresses",
                    "type": "string",
                    "label": "Email Addresses",
                    "title": "Email Field",
                    "usable": true,
                    "tooltip": "Multiple email addresses should be comma separated",
                    "dataType": "email",
                    "formType": "email",
                    "required": true,
                    "_expanded": true,
                    "mmdUpdate": true,
                    "collection": false,
                    "searchable": true,
                    "templateUrl": "app/components/form/fields/email.html",
                    "defaultValue": null,
                    "visibilityQuery": {
                      "sort": [],
                      "limit": 30,
                      "logic": "AND",
                      "filters": [
                        {
                          "type": "primitive",
                          "field": "doYouWantToSendSTIXFileThroughEmail",
                          "value": "false",
                          "operator": "isnull",
                          "_operator": "isnull"
                        },
                        {
                          "type": "primitive",
                          "field": "doYouWantToSendSTIXFileThroughEmail",
                          "value": true,
                          "operator": "eq",
                          "_operator": "eq"
                        }
                      ]
                    },
                    "lengthConstraint": true,
                    "allowedEncryption": true,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false,
                    "_addVisibilityConditions": true
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "emailAddresses": "{{vars.request.data[\"emailAddresses\"]}}",
                      "enterTheSTIXFilename": "{{vars.request.data[\"enterTheSTIXFilename\"]}}",
                      "doYouWantToSendSTIXFileThroughEmail": "{{vars.request.data[\"doYouWantToSendSTIXFileThroughEmail\"]}}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "indicators": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "fdd23ec4-1bd0-421c-bb38-a8a64892909e"
            },
            {
              "@type": "WorkflowStep",
              "name": "Find Indicators",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "object",
                      "field": "reputation",
                      "value": "/api/3/picklists/7074e547-7785-4979-be32-c6d0c863e4bd",
                      "_value": {
                        "@id": "/api/3/picklists/7074e547-7785-4979-be32-c6d0c863e4bd",
                        "itemValue": "Malicious"
                      },
                      "operator": "eq"
                    }
                  ],
                  "__selectFields": [
                    "lastSeen",
                    "firstSeen",
                    "value",
                    "description",
                    "sources",
                    "typeofindicator",
                    "reputation",
                    "createDate"
                  ]
                },
                "module": "indicators?$limit=30",
                "checkboxFields": true,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "group": null,
              "uuid": "3b2a55d0-9595-4fc8-8cd2-5b3efa36158b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Is File Send Over the Email",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "No",
                    "step_iri": "/api/3/workflow_steps/e4cf3ea0-ff4b-4fe6-9257-20afd71377a2",
                    "condition": "{{ vars.input.params.doYouWantToSendSTIXFileThroughEmail == None or vars.input.params.doYouWantToSendSTIXFileThroughEmail==false }}",
                    "step_name": "Create Attachment"
                  },
                  {
                    "option": "Yes",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/c6d98ec0-632a-4d8c-8462-416e6d4e2ed5",
                    "step_name": "Compress File"
                  }
                ]
              },
              "status": null,
              "top": "435",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "group": null,
              "uuid": "d67f745e-6e85-4362-894d-e8d9f852fdc7"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Compress File -> Send Email",
              "targetStep": "/api/3/workflow_steps/dec575d4-23ff-42b7-bbce-c75d288fe57e",
              "sourceStep": "/api/3/workflow_steps/c6d98ec0-632a-4d8c-8462-416e6d4e2ed5",
              "label": null,
              "isExecuted": false,
              "uuid": "8096995e-2d8c-428e-8119-28708757613a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is File Send Over the Email -> Create Attachment",
              "targetStep": "/api/3/workflow_steps/e4cf3ea0-ff4b-4fe6-9257-20afd71377a2",
              "sourceStep": "/api/3/workflow_steps/d67f745e-6e85-4362-894d-e8d9f852fdc7",
              "label": "No",
              "isExecuted": false,
              "uuid": "8a6f8b8f-d243-475c-87fe-60b714b816e1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is File Send Over the Email -> Compress File",
              "targetStep": "/api/3/workflow_steps/c6d98ec0-632a-4d8c-8462-416e6d4e2ed5",
              "sourceStep": "/api/3/workflow_steps/d67f745e-6e85-4362-894d-e8d9f852fdc7",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "9f069a19-062b-437b-8bd7-97a7386f4640"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Find Indicators",
              "targetStep": "/api/3/workflow_steps/3b2a55d0-9595-4fc8-8cd2-5b3efa36158b",
              "sourceStep": "/api/3/workflow_steps/fdd23ec4-1bd0-421c-bb38-a8a64892909e",
              "label": null,
              "isExecuted": false,
              "uuid": "e8625893-86a2-4d90-9678-074868bd7d6c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Find Indicators -> Export Indicator in STIX Spec",
              "targetStep": "/api/3/workflow_steps/b81a1251-2835-4167-b765-62cab8408ef1",
              "sourceStep": "/api/3/workflow_steps/3b2a55d0-9595-4fc8-8cd2-5b3efa36158b",
              "label": null,
              "isExecuted": false,
              "uuid": "6324e515-2349-46eb-ad17-7769398e169e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Export Indicator in STIX Spec -> Is File Send Over the Email",
              "targetStep": "/api/3/workflow_steps/d67f745e-6e85-4362-894d-e8d9f852fdc7",
              "sourceStep": "/api/3/workflow_steps/b81a1251-2835-4167-b765-62cab8408ef1",
              "label": null,
              "isExecuted": false,
              "uuid": "4f87685f-e63d-4732-aa51-c4f83226fdd3"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "63d500aa-ccf7-4b4c-af35-9e43dce5d3de",
          "id": 649,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "STIX"
          ]
        }
      ]
    }
  ],
  "exported_tags": [
    "STIX"
  ]
}